<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedback - AgroSense</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        .form-input:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .star {
            color: #d1d5db;
            cursor: pointer;
            transition: color 0.2s;
        }

        .star:hover,
        .star.active {
            color: #fbbf24;
        }

        .emoji {
            font-size: 2rem;
            cursor: pointer;
            opacity: 0.3;
            transition: all 0.2s;
        }

        .emoji:hover {
            transform: scale(1.2);
            opacity: 0.7;
        }

        .emoji.selected {
            opacity: 1;
            transform: scale(1.3);
        }

        @media (max-width: 640px) {
            .emoji {
                font-size: 1.5rem;
            }
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #10b981;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <div class="bg-green-600 text-white py-4 px-4">
        <div class="max-w-4xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-2">
                <i class="fas fa-leaf text-xl"></i>
                <span class="text-lg font-bold">AgroSense</span>
            </div>
            <a href="index.html" class="text-sm hover:underline">
                <i class="fas fa-arrow-left mr-1"></i>Back
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-2xl mx-auto px-4 py-6 sm:py-8">
        <!-- Title -->
        <div class="text-center mb-6">
            <i class="fas fa-comments text-4xl text-green-600 mb-3"></i>
            <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">Share Your Feedback</h1>
            <p class="text-gray-600">Help us improve AgroSense</p>
        </div>

        <!-- Form Card -->
        <div class="bg-white rounded-lg shadow-md p-4 sm:p-6 md:p-8">
            <form id="feedbackForm" class="space-y-6">
                
                <!-- Web3Forms Access Key (Hidden) -->
                <input type="hidden" name="access_key" value="2b372a4a-76cd-4a4f-b646-83c58c797176">
                
                <!-- Basic Info -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Name <span class="text-red-500">*</span>
                    </label>
                    <input type="text" name="name" id="name" required 
                        class="form-input w-full px-3 py-2 border-2 border-gray-300 rounded-lg"
                        placeholder="Your name">
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Phone <span class="text-red-500">*</span>
                    </label>
                    <input type="tel" name="phone" id="phone" required 
                        class="form-input w-full px-3 py-2 border-2 border-gray-300 rounded-lg"
                        placeholder="+91 XXXXX XXXXX">
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Email <span class="text-red-500">*</span>
                    </label>
                    <input type="email" name="email" id="email" required 
                        class="form-input w-full px-3 py-2 border-2 border-gray-300 rounded-lg"
                        placeholder="your@email.com">
                </div>

                <!-- Experience Rating -->
                <div class="border-t pt-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-3 text-center">
                        How was your experience? <span class="text-red-500">*</span>
                    </label>
                    <div class="flex justify-center gap-3 sm:gap-4">
                        <span class="emoji" data-value="Very Bad - üò¢" title="Very Bad">üò¢</span>
                        <span class="emoji" data-value="Bad - üòï" title="Bad">üòï</span>
                        <span class="emoji" data-value="Okay - üòê" title="Okay">üòê</span>
                        <span class="emoji" data-value="Good - üòä" title="Good">üòä</span>
                        <span class="emoji" data-value="Excellent - üòç" title="Excellent">üòç</span>
                    </div>
                    <input type="hidden" name="experience" id="experience" required>
                </div>

                <!-- Star Rating -->
                <div class="border-t pt-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-3">
                        Rate AgroSense
                    </label>
                    <div class="flex justify-center gap-2 text-3xl">
                        <i class="fas fa-star star" data-value="1"></i>
                        <i class="fas fa-star star" data-value="2"></i>
                        <i class="fas fa-star star" data-value="3"></i>
                        <i class="fas fa-star star" data-value="4"></i>
                        <i class="fas fa-star star" data-value="5"></i>
                    </div>
                    <input type="hidden" name="rating" id="rating">
                </div>

                <!-- Feedback Text -->
                <div class="border-t pt-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Your Feedback
                    </label>
                    <textarea name="feedback" id="feedback" rows="4"
                        class="form-input w-full px-3 py-2 border-2 border-gray-300 rounded-lg"
                        placeholder="Tell us what you think..."></textarea>
                </div>

                <!-- Suggestions -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Suggestions (Optional)
                    </label>
                    <textarea name="suggestions" id="suggestions" rows="3"
                        class="form-input w-full px-3 py-2 border-2 border-gray-300 rounded-lg"
                        placeholder="How can we improve?"></textarea>
                </div>

                <!-- Recommend -->
                <div class="border-t pt-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-3">
                        Would you recommend us?
                    </label>
                    <div class="flex flex-col sm:flex-row gap-3">
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="recommend" value="Yes üëç" class="mr-2">
                            <span>Yes üëç</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="recommend" value="Maybe ü§î" class="mr-2">
                            <span>Maybe ü§î</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="recommend" value="No üëé" class="mr-2">
                            <span>No üëé</span>
                        </label>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" id="submitBtn"
                    class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition flex items-center justify-center gap-2">
                    <i class="fas fa-paper-plane"></i>
                    <span id="btnText">Submit Feedback</span>
                </button>
            </form>

            <!-- Loading State -->
            <div id="loadingMsg" class="hidden text-center py-8">
                <div class="spinner mx-auto mb-4"></div>
                <p class="text-gray-600">Submitting your feedback...</p>
            </div>

            <!-- Success Message -->
            <div id="successMsg" class="hidden text-center py-8">
                <i class="fas fa-check-circle text-green-600 text-6xl mb-4"></i>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">Thank You! üôè</h3>
                <p class="text-gray-600 mb-4">Your feedback has been submitted successfully</p>
                <a href="index.html" 
                    class="inline-block bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition">
                    Back to Home
                </a>
            </div>

            <!-- Error Message -->
            <div id="errorMsg" class="hidden text-center py-8">
                <i class="fas fa-exclamation-circle text-red-600 text-6xl mb-4"></i>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">Oops! Something went wrong</h3>
                <p class="text-gray-600 mb-4">Please try again later</p>
                <button onclick="resetForm()" 
                    class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition">
                    Try Again
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="bg-gray-800 text-white text-center py-4 mt-8">
        <p class="text-sm">&copy; 2024 AgroSense. All rights reserved.</p>
    </div>

    <script>
        // Emoji Selection
        const emojis = document.querySelectorAll('.emoji');
        const experienceInput = document.getElementById('experience');

        emojis.forEach(emoji => {
            emoji.addEventListener('click', () => {
                emojis.forEach(e => e.classList.remove('selected'));
                emoji.classList.add('selected');
                experienceInput.value = emoji.dataset.value;
            });
        });

        // Star Rating
        const stars = document.querySelectorAll('.star');
        const ratingInput = document.getElementById('rating');

        stars.forEach((star, index) => {
            star.addEventListener('click', () => {
                ratingInput.value = `${index + 1} Stars`;
                stars.forEach((s, i) => {
                    s.classList.toggle('active', i <= index);
                });
            });
        });

        // Form Submit with Web3Forms API
        const form = document.getElementById('feedbackForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const loadingMsg = document.getElementById('loadingMsg');
        const successMsg = document.getElementById('successMsg');
        const errorMsg = document.getElementById('errorMsg');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Validate experience selection
            if (!experienceInput.value) {
                alert('Please select your experience!');
                return;
            }

            // Show loading state
            form.classList.add('hidden');
            loadingMsg.classList.remove('hidden');

            try {
                // Prepare form data
                const formData = new FormData(form);
                
                // Send to Web3Forms API
                const response = await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                // Hide loading
                loadingMsg.classList.add('hidden');

                if (data.success) {
                    // Show success message
                    successMsg.classList.remove('hidden');
                } else {
                    // Show error message
                    errorMsg.classList.remove('hidden');
                    console.error('Form submission error:', data);
                }

            } catch (error) {
                // Hide loading and show error
                loadingMsg.classList.add('hidden');
                errorMsg.classList.remove('hidden');
                console.error('Network error:', error);
            }
        });

        // Reset form function
        function resetForm() {
            errorMsg.classList.add('hidden');
            form.classList.remove('hidden');
            form.reset();
            emojis.forEach(e => e.classList.remove('selected'));
            stars.forEach(s => s.classList.remove('active'));
        }
    </script>
</body>
</html>